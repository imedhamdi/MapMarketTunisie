/* Leaflet overrides + cluster style */
.leaflet-container {
  font: inherit
}

.marker-cluster-small,
.marker-cluster-medium,
.marker-cluster-large {
  background: transparent
}

.marker-cluster div {
  background: linear-gradient(135deg, var(--primary), var(--primary-600));
  color: var(--color-text-contrast);
  border: 2px solid var(--color-text-contrast);
  box-shadow: 0 6px 16px rgba(var(--color-brand-rgb), .35);
}

.marker-cluster span {
  font-weight: 800
}

@keyframes mm-bounce {

  0%,
  100% {
    transform: translate3d(0, 0, 0) scale(1);
  }

  30% {
    transform: translate3d(0, -10px, 0) scale(1.02);
  }

  60% {
    transform: translate3d(0, -4px, 0) scale(1.01);
  }
}

.leaflet-marker-icon.mm-bounce {
  animation: mm-bounce 700ms cubic-bezier(.34, 1.56, .64, 1) both;
  will-change: transform;
}

.leaflet-tooltip.ad-hovercard {
  background: var(--color-surface);
  border: 0;
  padding: 0;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(var(--color-text-primary-rgb), .15);
  width: 290px;
  pointer-events: auto;
}

.leaflet-tooltip.ad-hovercard::before {
  content: "";
  position: absolute;
  left: 50%;
  margin-left: -8px;
  width: 0;
  height: 0;
  border: 8px solid transparent;
  transition: top .12s ease, bottom .12s ease;
}

.leaflet-tooltip.ad-hovercard.leaflet-tooltip-bottom::before {
  top: -8px;
  border-bottom-color: var(--color-text-contrast);
  border-top-color: transparent;
}

.leaflet-tooltip.ad-hovercard.leaflet-tooltip-top::before {
  bottom: -8px;
  border-top-color: var(--color-text-contrast);
  border-bottom-color: transparent;
}

.ad-card {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
}

.ad-card__media {
  display: block;
  width: 100%;
  height: 140px;
  object-fit: cover;
}

.ad-chip {
  position: absolute;
  left: 12px;
  top: 12px;
  background: var(--color-surface-raised);
  color: var(--color-text-contrast-strong);
  font: 600 12px/1.6 system-ui, Segoe UI, Roboto, Arial;
  padding: 2px 8px;
  border-radius: 999px;
}

.ad-price {
  position: absolute;
  right: 12px;
  top: 12px;
  background: var(--color-brand-contrast);
  color: var(--color-text-contrast);
  font: 700 12px/1.6 system-ui;
  padding: 4px 10px;
  border-radius: 999px;
}

.ad-body {
  padding: 12px 14px 14px;
}

.ad-title {
  margin: 0 0 6px;
  font: 600 15px/1.35 system-ui;
  color: var(--color-text-contrast-strong);
}

.ad-meta {
  display: flex;
  gap: 10px;
  align-items: center;
  color: var(--color-text-muted);
  font: 500 12px/1.4 system-ui;
  margin: 6px 0 12px;
}

.ad-meta svg {
  width: 14px;
  height: 14px;
}

.ad-cta {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 38px;
  border-radius: 10px;
  background: var(--color-outline-focus);
  color: var(--color-text-contrast);
  font: 600 14px/1 system-ui;
  text-decoration: none;
}

.ad-cta:focus-visible {
  outline: 2px solid var(--color-outline-focus);
  outline-offset: 2px;
}

.ad-enter {
  opacity: 0;
  transform: translateY(4px) scale(.98);
}

.ad-enter-active {
  opacity: 1;
  transform: translateY(0) scale(1);
  transition: opacity .14s ease, transform .14s ease;
}

/* Modern Circular Design */
.radius-modern__visual {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  min-height: 180px;
}

.radius-modern__circle {
  position: relative;
  width: 160px;
  height: 160px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--color-surface);
  border-radius: 50%;
  box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);
  border: 3px solid var(--color-brand-500);
}

.radius-modern__value {
  font-size: 48px;
  font-weight: 800;
  background: linear-gradient(135deg, var(--color-brand-500), var(--color-info-500));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1;
  margin: 0;
}

.radius-modern__unit {
  font-size: 16px;
  color: var(--color-text-muted);
  font-weight: 600;
  margin-top: 4px;
}

.radius-modern__pin {
  position: absolute;
  width: 28px;
  height: 28px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  opacity: 0.15;
  color: var(--color-text-muted);
}

.radius-modern__slider {
  position: relative;
  padding: 8px 0;
}

.radius-modern__input {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 8px;
  border-radius: 20px;
  background: linear-gradient(to right, 
    var(--color-brand-500) 0%, 
    var(--color-brand-500) var(--progress, 10%), 
    var(--color-surface-alt) var(--progress, 10%), 
    var(--color-surface-alt) 100%);
  outline: none;
  transition: background 0.2s;
}

.radius-modern__input::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--color-surface);
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(255, 77, 109, 0.4), 0 0 0 3px var(--color-brand-500);
  transition: transform 0.2s, box-shadow 0.2s;
}

.radius-modern__input::-webkit-slider-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(255, 77, 109, 0.5), 0 0 0 4px var(--color-brand-500);
}

.radius-modern__input::-webkit-slider-thumb:active {
  transform: scale(1.05);
}

.radius-modern__input::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--color-surface);
  cursor: pointer;
  border: none;
  box-shadow: 0 4px 12px rgba(255, 77, 109, 0.4), 0 0 0 3px var(--color-brand-500);
  transition: transform 0.2s, box-shadow 0.2s;
}

.radius-modern__input::-moz-range-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(255, 77, 109, 0.5), 0 0 0 4px var(--color-brand-500);
}

.radius-modern__input::-moz-range-thumb:active {
  transform: scale(1.05);
}

.radius-modern__marks {
  display: flex;
  justify-content: space-between;
  margin-top: 8px;
  padding: 0 4px;
}

.radius-modern__mark {
  font-size: 11px;
  color: var(--color-text-muted);
  font-weight: 600;
}

.radius-modern__toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 18px;
  background: var(--color-surface);
  border-radius: 12px;
  border: 1px solid var(--color-border-default);
  cursor: pointer;
  transition: all 0.2s;
  margin: 0;
}

.radius-modern__toggle:hover {
  border-color: var(--color-brand-500);
  background: var(--color-brand-tint);
}

.radius-modern__toggle-label {
  font-size: 14px;
  font-weight: 600;
  color: var(--color-text-primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.toggle-switch {
  position: relative;
  width: 48px;
  height: 26px;
  background: var(--color-border-default);
  border-radius: 20px;
  transition: background 0.3s;
  flex-shrink: 0;
  display: inline-block;
}

.toggle-switch::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--color-surface);
  top: 3px;
  left: 3px;
  transition: transform 0.3s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.hidden-checkbox {
  position: absolute;
  opacity: 0;
  pointer-events: none;
  width: 0;
  height: 0;
}

.hidden-checkbox:checked ~ .toggle-switch {
  background: var(--color-success-500);
}

.hidden-checkbox:checked ~ .toggle-switch::after {
  transform: translateX(22px);
}

/* Legacy support (kept for backward compatibility) */
.geo-row {
  display: grid;
  gap: 6px;
}

.geo-row.is-disabled {
  opacity: 0.5;
}

.geo-caption {
  font-size: 13px;
  color: var(--color-text-muted);
  font-weight: 600;
}

.geo-range {
  width: 100%;
  accent-color: var(--primary);
}

.geo-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: var(--color-text-primary);
}

.geo-toggle input {
  accent-color: var(--primary);
}

.geo-toast {
  grid-column: 2;
  grid-row: 1;
  justify-self: start;
  align-self: center;
  font-weight: 700;
  font-size: inherit;
  color: var(--primary);
  opacity: 0;
  pointer-events: none;
  transition: opacity 160ms ease, transform 160ms ease;
  white-space: nowrap;
  transform: translateY(4px);
}

.geo-btn.show-toast .geo-label {
  opacity: 0;
}

.geo-btn.show-toast .geo-toast {
  opacity: 1;
  transform: translateY(0);
}

/* === USER POSITION MARKER =============================================== */
.leaflet-marker-icon.geo-user{background:radial-gradient(circle at 50% 50%, #fff 0 28%, var(--primary) 30% 55%, rgba(255,255,255,.9) 58% 62%, transparent 64% 100%);border-radius:999px;box-shadow:0 6px 18px rgba(var(--color-brand-rgb),.35)}
.leaflet-marker-icon.geo-user::after{content:'';position:absolute;inset:-10px;border-radius:50%;border:2px solid rgba(var(--color-brand-rgb),.35);animation:geo-pulse 1.8s ease-out infinite}
@keyframes geo-pulse{0%{transform:scale(.7);opacity:.7}70%{transform:scale(1.4);opacity:.2}100%{transform:scale(1.6);opacity:0}}

/* Cercle de rayon (Leaflet Circle) */
.leaflet-interactive.geo-radius{fill:rgba(var(--color-sky-500-rgb),.10);stroke:rgba(var(--color-sky-500-rgb),.75);stroke-width:2}
